<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="author" content="m.9188.com">
	<meta name="format-detection" content="telephone=no" />
	<meta name="msapplication-tap-highlight" content="no">
	<meta http-equiv="cleartype" content="on">
	<meta http-equiv="Page-Enter" content="revealTrans(Duration=2.0,Transition=12)" />
	<title>9188-大圣归来-写文章</title>
	<link href="../css/reset.css" rel="stylesheet" type="text/css">
	<link href="../css/bass.css" rel="stylesheet" type="text/css">
</head>
<body>
	<!-- 编辑博客-->
	<div class="blog-content">
		<div class="blog-left">
			<div class="blog-home"> 
				<a href="/" class="go-home">
					<span>回首页</span>
				</a>
			</div>
			<div class="new-articleBox">
				<span>新建文集</span>
			</div>
			<ul class="nav-item">
				<li class="active">
					<a>日记本</a>
				</li>
				<li>
					<a>随笔</a>
				</li>
			</ul>
		</div>
		<div class="blog-middle">
			<div class="article-list">
				<div class="new-article">
					<span>新建文章</span>
				</div>
				<ul id="article-list">
					<li class='active'>
						<span>
							<img src="icon/ico-book.png">
						</span>
						<span>
							<h3>文章标题</h3>
							<p>描述描述描述描述描述描述描述描述描述描述</p>
						</span>
					</li>
					<li class=''>
						<span>
							<img src="icon/ico-book.png">
						</span>
						<span>
							<h3>文章标题</h3>
							<p>描述描述描述描述描述描述描述描述描述描述</p>
						</span>
					</li>
				</ul>
			</div>
		</div>
		<div class="blog-right">
			<div class="edit">
				<div class="publish">发布</div>
				<div class="edit-header" id="edit-header"></div>
				<div class="edit-text" id="edit-text" contenteditable=true></div>
			</div>
		</div>
	</div>
	
<script src="../js/libs/zepto.min.js"></script>
<script type="text/javascript">
	var h = $(window).height();
	$('.blog-content > div').height(h);//三个div高度
	$('.edit-text').height(h-40);//编辑器的高
	
	//新建文章
	$('.new-article').click(function(){
		var _out=[];
		_out.push('<li><span><img src="icon/ico-book.png"></span><span><h3>文章标题</h3><p>描述描述描述描述描述描述描述描述描述描述</p></span></li>');
		$('#article-list').html(function(i, v){
			return v + _out.join('')  
		});
	});

	initEdit();

	function initEdit(){
		bindBtnComand();
	}

	//初始化
	(function (){
		var isHtml = document.getElementById('edit-text');
		if(isHtml.innerHTML == ''){
			var div= document.createElement('div');
			div.innerHTML= '请输入...';
			div.style.color = '#ccc';
			div.id = 'edit-tip';
			isHtml.appendChild(div);
			isHtml.onfocus = function(){
				document.getElementById('edit-tip').style.display = 'none'
			}
		}
	})()
	function bindBtnComand(){
		var editHeader = document.getElementById('edit-header');
		var btnConfigs = "bold|null|粗体 italic|null|斜体 strikeThrough|null|删除线 formatBlock|H1|H1 formatBlock|H2|H2 formatBlock|H3|H3 formatBlock|BLOCKQUOTE|引用 formatBlock|div|结束引用 undo|null|撤销 redo|null|重做 formatBlock|img|图片".split(" ");
		//动态生成按钮
		for(var i=0;i<btnConfigs.length;i++){
			var a = document.createElement('a');
			a.className = 'edit-btn';
			a.href = "javascript:;"
			a.id = 'edit-tool' + i;
			var img = document.createElement('img');
			a.appendChild(img);//img放入a
			editHeader.appendChild(a);//a 放入最外层可编辑的div
		}
		//给按钮绑定功能
		var btns = editHeader.getElementsByTagName('a');
		var imgs = editHeader.getElementsByTagName('img');
		for (var i = 0,btnConfig; btnConfig = btnConfigs[i];i++) {
			(function(btnConfig,btn){
				var mag = btnConfig.split('|'),lab=mag[0],value= mag[1],title= mag[2];
				imgs[i].src= "icon/"+title+".png";
				btn.title= title;
				btn.onclick = function(e){
					var aa = document.execCommand(lab,false, value);
					console.log(aa)
				}
			})(btnConfig, btns[i])
		}

	}
</script>
</body>
</html>
